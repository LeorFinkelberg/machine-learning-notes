Приложение^[Приложение (Application) -- программа, которая состоит из _программы-драйвера_ и _исполнителей в кластере_] устанавливает соединение с ведущим узлом кластера Spark. После этого оно сообщает кластеру, что необходимо делать: приложение управляет кластером. В рассматриваемом здесь варианте ведущий узел (master) начинает с загрузки файла в формате CSV, а заканчивает сохранением полученного результата в базе данных.

#### Установление соединения с ведущим узлом

Для каждого _приложения_ (application) Spark первой операцией является установление соединения с _ведущим узлом_ (master) Spark и _создание сеанса_ (session) Spark
```java
SparkSession spark = SparkSession
  .builder()
  .appName("CSV to DB")
  .master("local")  // ведущий узел
  .getOrCreate();
```

#### Загрузка или потребления содержимого CSV-файла

Загрузка (loading), потребление (ingesting) и считывание (reading) -- это синонимы. Распределенное потребление (distributed ingestion) означает, что вы обращаетесь к рабочим узлам для одновременного выполнения операции потребления.

_Ведущий узел_ приказывает _рабочим узлам_ загрузить указанный файл. Spark будет потреблять этот CSV-файл распределенным методом. Файл обязательно должен находиться на совместно используемом накопителе (диске), в распределенной файловой системе (например, HDFS) или использоваться через специализированный механизм совместно используемой файловой системы, такой как Dropbox, Nextcloud или ownCloud.

_Раздел_ (partion) -- это специально выделенная ==область в памяти== _рабочего узла_. Каждый рабочий узел имеет свою собственную память, которую он использует через разделы (partions). 

_Рабочие узлы_ создают _задачи_ (tasks) для считывания CSV-файла. Каждый _рабочий узел_ получает доступ к собственной памяти и назначает _раздел памяти_ (партицию) для _задачи_.

Когда _задача_ (task) потребляет строки файла, она сохраняет считанные данные в выделенном _разделе памяти_ (partion).

Основные положения [[Литература#^61ef72]]<c. 68>:
- Набор данных никогда не остается целиком в _приложении_ (драйвере). Набор данных распределяется между _разделами памяти_ на _рабочих узлах_, а ==не на драйвере==.
- Весь процесс обработки данных выполняется на рабочих узлах,
- Рабочие узлы сохраняют обработанные данные из собственных разделов памяти в базу данных. 

Сводка:
- _Приложение_ является _драйвером_. 
- Драйвер устанавливает соединение с _ведущим узлом_ и _создает сеанс_. Данные будут прикреплены к этому сеансу. Сеанс определяет жизненный цикл данных на рабочих узлах.
- Ведущий узел может быть _локальным_ (ваш локальный компьютер) или _удаленным кластером_. При использовании локального режима не требуется создание кластера.
- Данные распределяются и обрабатываются в определенном разделе памяти.

